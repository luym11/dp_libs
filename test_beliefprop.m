% Call beliefprop
P1=[0.2 0.8;0.7 0.3];
R1(1,:,:)=[0.9 0.7;0.6 0.5];
R1(2,:,:)=ones(2,2)-[0.9 0.7;0.6 0.5];
X1=[0.7 0.3];
z1=1;

Xnew1=beliefprop(P1,R1,X1,z1)

% Xnew1 =
% 
%     0.3657    0.6343



P2=[0.2 0.6 0.2;0.7 0.2 0.1;0.3 0.65 0.05];
R2(1,:,:)=[0.7 0.5 0.4;0.6 0.5 0.6;0.2 0.5 0.7];
R2(2,:,:)=[0.1 0.2 0.5;0.1 0.4 0.2;0.4 0.2 0.1];
R2(3,:,:)=[0.2 0.3 0.1;0.3 0.1 0.2;0.4 0.3 0.2];
X2=[0.6 0.1 0.3];
z2=3;

Xnew2=beliefprop(P2,R2,X2,z2)

% Xnew2 =
% 
%     0.3039    0.6323    0.0638